# yaml-language-server: $schema=./node_modules/envio/evm.schema.json
name: satoshi-split-indexer
description: Multi-chain expense splitting indexer for SatoshiSplit

contracts:
  - name: SplitManager
    handler: src/EventHandlers.ts
    events:
      - event: 'SplitCreated(uint256 indexed splitId, address indexed creator, address[] initialMembers, address defaultToken)'
      - event: 'MemberAdded(uint256 indexed splitId, address indexed member)'
      - event: 'MemberRemoved(uint256 indexed splitId, address indexed member)'
      - event: 'SpendingAdded(uint256 indexed splitId, uint256 spendingId, string title, address indexed payer, uint256 amount, address[] forWho, address token)'
      - event: 'DebtPaid(uint256 indexed splitId, address indexed debtor, address indexed creditor, uint256 amount, address token)'
  - name: PoolManager
    handler: src/EventHandlers.ts
    events:
      - event: Approval(address indexed owner, address indexed spender, uint256 indexed id, uint256 amount)
      - event: Donate(bytes32 indexed id, address indexed sender, uint256 amount0, uint256 amount1)
      - event: Initialize(bytes32 indexed id, address indexed currency0, address indexed currency1, uint24 fee, int24 tickSpacing, address hooks, uint160 sqrtPriceX96, int24 tick)
      - event: ModifyLiquidity(bytes32 indexed id, address indexed sender, int24 tickLower, int24 tickUpper, int256 liquidityDelta, bytes32 salt)
        field_selection:
          transaction_fields:
            - 'hash'
            - 'from'
      - event: OperatorSet(address indexed owner, address indexed operator, bool approved)
      - event: OwnershipTransferred(address indexed user, address indexed newOwner)
      - event: ProtocolFeeControllerUpdated(address indexed protocolFeeController)
      - event: ProtocolFeeUpdated(bytes32 indexed id, uint24 protocolFee)
      - event: Swap(bytes32 indexed id, address indexed sender, int128 amount0, int128 amount1, uint160 sqrtPriceX96, uint128 liquidity, int24 tick, uint24 fee)
        field_selection:
          transaction_fields:
            - 'hash'
            - 'from'
      - event: Transfer(address caller, address indexed from, address indexed to, uint256 indexed id, uint256 amount)
  - name: PositionManager
    handler: src/EventHandlers.ts
    events:
      - event: Approval(address indexed owner, address indexed spender, uint256 indexed id)
      - event: ApprovalForAll(address indexed owner, address indexed operator, bool approved)
      - event: Subscription(uint256 indexed tokenId, address indexed subscriber)
      - event: Transfer(address indexed from, address indexed to, uint256 indexed id)
      - event: Unsubscription(uint256 indexed tokenId, address indexed subscriber)

networks:
  - id: 11155111
    start_block: 9405553
    contracts:
      - name: SplitManager
        address:
          - '0x3dA416c0B71a28044003d8AA6de6584822F045f9'
  - id: 1
    start_block: 0
    contracts:
      - name: PositionManager
        address:
          - '0xbD216513d74C8cf14cf4747E6AaA6420FF64ee9e'
      - name: PoolManager
        address:
          - '0x000000000004444c5dc75cB358380D2e3dE08A90'

unordered_multichain_mode: false
preload_handlers: true
address_format: lowercase

field_selection:
  transaction_fields:
    - 'from'
    - 'to'
    - 'hash'
    - 'transactionIndex'
    - 'gasPrice'
